c("Other Revnues, Total", get_num(5))
rbind(
c("Revenues", get_num(4))
c("Other Revnues, Total", get_num(5))
rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5))
)
do.rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5))
)
as_tibble(rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5))
))
as_tibble(rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5)),
c("Total Revenues", get_num(6)),
c("Depreciation & Amortization", get_num(8)),
c("Depreciation & Amortization", get_num(9)),
c("Other Operating Expenses", get_num(10)),
c("Total Operating Expenses", get_num(11)),
c("Operating Income", get_num(12)),
c("Interest Expense, Total", get_num(14)),
c("Allow. For Equity Funds Used For Const.", get_num(18)),
c("Other Non-Operating Inc. (Exp.)", get_num(20)),
))
as_tibble(rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5)),
c("Total Revenues", get_num(6)),
c("Depreciation & Amortization", get_num(8)),
c("Depreciation & Amortization", get_num(9)),
c("Other Operating Expenses", get_num(10)),
c("Total Operating Expenses", get_num(11)),
c("Operating Income", get_num(12)),
c("Interest Expense, Total", get_num(14)),
c("Allow. For Equity Funds Used For Const.", get_num(18)),
c("Other Non-Operating Inc. (Exp.)", get_num(20))
))
df1 <- as_tibble(rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5)),
c("Total Revenues", get_num(6)),
c("Depreciation & Amortization", get_num(8)),
c("Depreciation & Amortization", get_num(9)),
c("Other Operating Expenses", get_num(10)),
c("Total Operating Expenses", get_num(11)),
c("Operating Income", get_num(12)),
c("Interest Expense, Total", get_num(14)),
c("Allow. For Equity Funds Used For Const.", get_num(18)),
c("Other Non-Operating Inc. (Exp.)", get_num(20))
))
map_dbl(21:40,get_num)
map_chr(21:40,get_num)
map_lgl(21:40,get_num)
map_raw(21:40,get_num)
map_raw(21,get_num)
get_num(21)
c(get_num(21))
as_tibble(rbind(
c("Revenues", get_num(21)),
c("Other Revnues, Total", get_num(5)),
c("Total Revenues", get_num(6)),
c("Depreciation & Amortization", get_num(8)),
c("Depreciation & Amortization", get_num(9)),
c("Other Operating Expenses", get_num(10)),
c("Total Operating Expenses", get_num(11)),
c("Operating Income", get_num(12)),
c("Interest Expense, Total", get_num(14)),
c("Allow. For Equity Funds Used For Const.", get_num(18)),
c("Other Non-Operating Inc. (Exp.)", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("Other Unusual Items", get_num(22)),
c("EBT, Incl. Unusual Items", get_num(6)),
c("Income Tax Expense", get_num(8)),
c("Earnings From Continuing Operations", get_num(9)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(23)),
c("Income Tax Expense", get_num(8)),
c("Earnings From Continuing Operations", get_num(9)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(24)),
c("Income Tax Expense", get_num(8)),
c("Earnings From Continuing Operations", get_num(9)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(8)),
c("Earnings From Continuing Operations", get_num(9)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(9)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(27)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Net Income to Company", get_num(10)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Net Income to Company", get_num(29)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Net Income to Company", get_num(30)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Net Income to Company", get_num(31)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(29)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(27)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Minority Interest", get_num(11)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Minority Interest", get_num(33)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Minority Interest", get_num(34)),
c("Net Income", get_num(12)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(33)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
get_num <- function(x){
row <- pdf[x] %>% toString() %>% str_squish() %>% strsplit(" ")
max_n <- length(row[[1]])
start_n <- max_n - 3
nums <- row[[1]][start_n:max_n]
nums <- gsub("\\(", "-", nums)
nums <- gsub("\\)", "", nums)
nums <- as.double(gsub(",", "", nums))
nums <- str_split(nums, " ") %>% unlist() %>% as.double()
nums
}
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(14)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(35)),
c("NI to Common Incl Extra Items", get_num(18)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(35)),
c("NI to Common Incl Extra Items", get_num(36)),
c("NI to Common Excl. Extra Items", get_num(20))
))
as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(35)),
c("NI to Common Incl Extra Items", get_num(36)),
c("NI to Common Excl. Extra Items", get_num(37))
))
df2 <- as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(35)),
c("NI to Common Incl Extra Items", get_num(36)),
c("NI to Common Excl. Extra Items", get_num(37))
))
df1
df2
rbind(df1,df2)
df <- rbind(df1,df2)
colnames(df) <- c("Type", "Dec 2017", "Dec 2018", "Dec 2019", "TTM")
df
df1 <- as_tibble(rbind(
c("Revenues", get_num(4)),
c("Other Revnues, Total", get_num(5)),
c("Total Revenues", get_num(6)),
c("Depreciation & Amortization", get_num(8)),
c("Depreciation & Amortization", get_num(9)),
c("Other Operating Expenses", get_num(10)),
c("Total Operating Expenses", get_num(11)),
c("Operating Income", get_num(12)),
c("Interest Expense, Total", get_num(14)),
c("Allow. For Equity Funds Used For Const.", get_num(18)),
c("Other Non-Operating Inc. (Exp.)", get_num(20))
))
df2 <- as_tibble(rbind(
c("EBT, Excl. Unusual Items", get_num(21)),
c("EBT, Incl. Unusual Items", get_num(25)),
c("Income Tax Expense", get_num(26)),
c("Earnings From Continuing Operations", get_num(28)),
c("Earnings Of Discontinued Operations", get_num(31)),
c("Net Income to Company", get_num(32)),
c("Net Income", get_num(34)),
c("Pref. Dividends and Other Adj.", get_num(35)),
c("NI to Common Incl Extra Items", get_num(36)),
c("NI to Common Excl. Extra Items", get_num(37))
))
df <- rbind(df1,df2)
colnames(df) <- c("Type", "Dec 2017", "Dec 2018", "Dec 2019", "TTM")
df
write_csv(df, "fe_financial_statements.csv")
getwd()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dbplyr)
library(RSQLite)
?factor
factor(c("efile", "paper", NA))
factor(c("efile", "paper", "NA"))
filing_status <- factor(c("efile", "paper", "NA"))
n_dep <- factor(c(0, 1, 2, 3, 4, 5, 6, 7, 8), ordered = T)
n_dep
filing_mthd <- factor(c("efile", "paper", "NA"))
filing_status <- factor(c("single", "head of household", "joint", "married, separate", "window(ed)"))
filing_status <- factor(c("single", "head of household", "joint", "married, separate", "window(ed)"), ordered = T)
group <- factor(c("IDT", "TAS", "OLS", "Other"))
df <- tibble(filing_mthd)
tibble(filing_mthd)
sample(filing_mthd, 100, replace = T)
sample(filing_mthd, 100, replace = T, prob = c(0.5, 0.4, 0.1))
tibble(filing_mthd = sample(filing_mthd, 100, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(filing_mthd, 100, replace = T))
tibble(filing_mthd = sample(filing_mthd, 100, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(n_dep 100, replace = T))
tibble(filing_mthd = sample(filing_mthd, 100, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(n_dep, 100, replace = T))
tibble(group =  sample(group, 100, replace = T),
filing_mthd = sample(filing_mthd, 100, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(n_dep, 100, replace = T))
tibble(group =  sample(group, 10000, replace = T),
filing_mthd = sample(filing_mthd, 10000, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(n_dep, 10000, replace = T),
filing_status =  sample(filing_status, 10000, replace = T))
df <- tibble(group =  sample(group, 10000, replace = T),
filing_mthd = sample(filing_mthd, 10000, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(n_dep, 10000, replace = T),
filing_status =  sample(filing_status, 10000, replace = T))
getwd()
df %>% count()
df %>% count(group, filing_status, n_dep, filing_status)
df %>% count(group, filing_status, n_dep, filing_status, sort = T)
write_csv(df, "df.csv")
filing_mthd <- factor(c("efile", "paper", "NA"))
n_dep <- factor(c(0, 1, 2, 3, 4, 5, 6, 7, 8), ordered = T)
filing_status <- factor(c("single", "head_of_household", "joint", "married/separate", "window(ed)"), ordered = T)
group <- factor(c("IDT", "TAS", "OLS", "Other"))
df <- tibble(group =  sample(group, 10000, replace = T),
filing_mthd = sample(filing_mthd, 10000, replace = T, prob = c(0.5, 0.4, 0.1)),
n_dep = sample(n_dep, 10000, replace = T),
filing_status =  sample(filing_status, 10000, replace = T))
write_csv(df, "df.csv")
list.files()
getwd()
write_csv(df, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
write_csv(df %>% slice(1:100), "/Users/amanda/GitHub/React-D3-Tests/df.csv")
df2 <- df %>% count(group, filing_status, n_dep, filing_status, sort = T)
write_csv(df, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
write_csv(df2, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
df2 <- df %>% count(group, filing_status, n_dep, filing_mthd, sort = T)
write_csv(df2, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
df2 <- df %>% count(group, filing_status, n_dep, filing_mthd, sort = T)
write_csv(df2, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
write_csv(df2, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
jsonlite::toJSON(df2)
df %>%
group_by(group) %>%
count(filing_status, n_dep, filing_mthd, sort = T)
df2 <- df %>%
group_by(group) %>%
summarize(filing_status_sum = sum(n))
df %>%
group_by(group)
df2 <- df %>%
group_by(group) %>%
summarize(filing_status_sum = sum(filing_status))
df %>%
group_by(group) %>%
summarize(filing_status_sum = sum(filing_status))
df %>%
group_by(group) %>%
count(filing_status, n_dep, filing_mthd, sort = T)
df %>%
group_by(group) %>%
count(filing_status, n_dep, filing_mthd, sort = T) %>%
summarize(n = sum(n))
df %>%
group_by(group, filing_status) %>%
count(n_dep, filing_mthd, sort = T) %>%
summarize(n = sum(n))
df2 <- df %>%
group_by(group, filing_status) %>%
count(n_dep, filing_mthd, sort = T) %>%
summarize(n = sum(n))
write_csv(df2, "/Users/amanda/GitHub/React-D3-Tests/df.csv")
jsonlite::write_json(jsonlite::toJSON(df2), "/Users/amanda/GitHub/React-D3-Tests/df.json")
jsonlite::write_json(jsonlite::toJSON(df2), "/Users/amanda/GitHub/React-D3-Tests/df.json", pretty = F)
jsonlite::write_json(jsonlite::toJSON(df2), "/Users/amanda/GitHub/React-D3-Tests/df.json", pretty = F)
jsonlite::write_json(jsonlite::toJSON(df2), "/Users/amanda/GitHub/React-D3-Tests/df.json", pretty = F)
setwd("~/GitHub")
setwd("~/GitHub/React-D3-Tests")
